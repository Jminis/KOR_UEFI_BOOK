# 32. EFI\_PCI\_IO\_PROTOCOL을 사용해 PCI 옵션 ROM 이미지 표시

이번 장에서는 시스템의 PCI Device에 존재하는 OptionROM을 확인한다.

그래픽 카드와 같은 일부 PCI 장치는 BIOS 단계에서 작동하기 위해 추가적인 드라이버가 필요하다.

그러나 BIOS는 OS가 아니기 때문에 보드에 연결할 수 있는 모든 PCI 장치의 드라이버를 모두 포함할 수는 없다. 이런 문제를 해결하기 위해 복잡한 PCI 장치는 자체 펌웨어를 드라이버로 저장한다. 이게 PCI Option ROM으로 알려진 개념이다.\
[https://en.wikipedia.org/wiki/Option\_ROM](https://en.wikipedia.org/wiki/Option\_ROM)

BIOS는 모든 PCI 장치의 PCI 구성 공간을 쿼리하고 option ROM이 있는지 확인한다. BIOS가 있는 경우 BIOS 설정에 따라 option ROM에서 코드를 실해할 수 있다.

PCI Option ROM은 그 자체로 여러 코드 이미지를 가질 수 있다. 일반적인 경우는 option ROM에 두 개의 이미지가 포함되어 있다.

* driver for legacy BIOS (Legacy OpROM)
* driver for the UEFI BIOS (UEFI OpROM)

오래된 카드는 Legacy BIOS용 드라이버만 포함할 수 있고, 최신/미래의 카드는 UEFI BIOS용 드라이버만 포함할 수 있다.

현재는 Legacy BIOS 인터페이스를 UEFI 전환하고 있다. UEFI 펌웨어는 Legacy OpROM과 함께 동작할 수 없다. 그러나 현재 Vendor들은 여전히 CSM 모드를 통해 Legacy 인터페이스로 작업할 수 있도록 했다.
