# 20. PCD 소개

PCD(Platform Configuration Database)는 드라이버 또는 응용 프로그램이 액세스할 수 있는 다양한 현재 플랫폼 설정 또는 지침이 포함된 데이터베이스이다.

PCD에 대한 자세한 설명은 edk2 사양을 통해 확인할 수 있다.\
\- [https://edk2-docs.gitbook.io/edk-ii-pcd-specification/](https://edk2-docs.gitbook.io/edk-ii-pcd-specification/)\
\- [https://www.intel.com/content/dam/www/public/us/en/documents/white-papers/edkii-platform-config-database-entries-paper.pdf](https://www.intel.com/content/dam/www/public/us/en/documents/white-papers/edkii-platform-config-database-entries-paper.pdf)

PCD 엔트리는 PCD라고도 불린다. 그래서 여기서도 그냥 PCD라고 부를 것이다.

PCD 엔트리는 DEC 파일에 정의된다.

`<TokenSpaceGuidCName>` 은 GUID 값이고, `<Token>`은 32bit 값이다. 이것들은 PCD를 식별하는 데 사용된다.

```
<TokenSpaceGuidCName>.<PcdCName>|<DefaultValue>|<DatumType>|<Token>
```

먼저 모든 PCD를 포함하는 토큰 공간을 선언한다. 일반적으로 `in`은 `g<PakageName>TokenSpaceGuid`로 정의되기 때문에 `UefiLessonsPkg/UefiLessonsPkg.dec`에 추가해야 한다.

```
[Guids]
  ...
  gUefiLessonsPkgTokenSpaceGuid = {0x150cab53, 0xad47, 0x4385, {0xb5, 0xdd, 0xbc, 0xfc, 0x76, 0xba, 0xca, 0xf0}}
```

`<Token>` 값의 경우, 일반적으로 패키지 작성자는 `0x00000001`부터 순차적으로 쓰기 시작한다. 또한 일부 PCD가 하나의 논리 그룹에 속한다는 것을 나타내기 위해 종종 토큰 번호를 사용하여 이를 나타낼 수 있다. 예를 들어 토큰 그룹은 `0x1XXXXXXX`, `0x2XXXXXXX` 등이 될 수 있다.

패키지가 발전함에 따라 일부 PCD가 추가되고 일부 PCD가 제거된다. 만약 순차적인 번호를 사용한다면 이것은 어려움을 줄 수 있다. 예를 들어 토큰이 `0x0000000A` 및 `0x0000000B`인 PCD가 있는 경우 어려움이 발생할 수 있으며 새 PCD를 넣는 가장 논리적인 방법은 `0x0000000A`인 PCD 이후이다. 물론 PCD 토큰을 `0x0000000C`에 할당하여 실행할 수도 있지만, 그렇다면 순차적인 번호 지정의 의미를 알아야 한다.

순차적인 번호 지정으로 인해 아래 스크립트를 생성했다. 아래  스크립트는의임의 4바이트 토큰 번호를 생성하는 스크립트다.

```
#!/bin/bash

##
#  This is a simple script that generates a random 4-byte hex value for a PCD Token
##

hexdump -vn4 -e'"0x%08X\n"' /dev/urandom
```

스크립트를 사용하면 아래와 같이 4바이트의 토큰 번호를 생성할 수 있다.

```
$ ./scripts/genToken.sh
0x3B81CDF1
```

